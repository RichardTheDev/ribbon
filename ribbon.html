<!-- <!DOCTYPE html>
<html>
<head>
    <title>Translate Text</title>
    <script>
        Office.onReady((info) => {
            if (info.host === Office.HostType.Outlook) {
                document.getElementById("translate-button").onclick = translateText;
            }
        });

        async function translateText() {
            try {
                const item = Office.context.mailbox.item;
                const selectedData = await new Promise((resolve, reject) => {
                    item.getSelectedDataAsync(Office.CoercionType.Text, (result) => {
                        if (result.status === Office.AsyncResultStatus.Succeeded) {
                            resolve(result);
                        } else {
                            reject(result.error);
                        }
                    });
                });
                
                const selectedText = selectedData.value;

                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'x-api-key': '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',
                        'anthropic-version': '2023-06-01',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'claude-3-5-sonnet-20240620',
                        max_tokens: 1024,
                        messages: [
                            { role: 'user', content: `Translate this text in Hebrew, return only the translation: ${selectedText}` }
                        ]
                    })
                });

                const result = await response.json();
                const translatedText = result.choices[0].message.content;

                // Replace the selected text with the translated text
                await new Promise((resolve, reject) => {
                    item.body.setSelectedDataAsync(translatedText, { coercionType: Office.CoercionType.Text }, (result) => {
                        if (result.status === Office.AsyncResultStatus.Succeeded) {
                            resolve();
                        } else {
                            reject(result.error);
                        }
                    });
                });

            } catch (error) {
                console.error('Error translating text:', error);
            }
        }
    </script>
</head>
<body>
    <button id="translate-button">Translate Text</button>
</body>
</html> -->
<!DOCTYPE html>
<html>
<head>
  <title>Translate Email</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script>
    Office.onReady(info => {
      if (info.host === Office.HostType.Outlook) {
        document.getElementById('translateButton').onclick = translateEmail;
      }
    });

    function translateEmail() {
      Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text, (result) => {
        if (result.status === Office.AsyncResultStatus.Failed) {
          console.error(result.error.message);
          return;
        }

        const emailText = result.value;
        const apiUrl = 'https://us-central1-auditex-b2a31.cloudfunctions.net/function-1-test';
        const requestData = {
          text: emailText
        };

        fetch(apiUrl, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(requestData)
        })
          .then(response => response.json())
          .then(data => {
            const translatedText = data.translation;
            document.getElementById('translatedText').innerText = translatedText;
            document.getElementById('translatedSection').style.display = 'block';
            console.log('Translation retrieved successfully');
          })
          .catch(error => {
            console.error('Error translating email:', error);
          });
      });
    }

    function copyToClipboard() {
      const translatedText = document.getElementById('translatedText').innerText;
      navigator.clipboard.writeText(translatedText).then(() => {
        alert('Translated text copied to clipboard!');
      }, (err) => {
        console.error('Error copying text: ', err);
      });
    }
  </script>
</head>
<body>
  <button id="translateButton">Translate to Hebrew</button>
  <div id="translatedSection" style="display:none; margin-top:20px;">
    <h3>Translated Text:</h3>
    <p id="translatedText" style="border:1px solid #ccc; padding:10px;"></p>
    <button onclick="copyToClipboard()">Copy Translated Text</button>
  </div>
</body>
</html>


